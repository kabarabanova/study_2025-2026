---
## Front matter
title: "Лабораторная работа №6"
subtitle: "Настройка пропускной способности глобальной сети с помощью Token Bucket Filter
"
author: "Барабанова Кристина"

## Generic options
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: false
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt

## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english

## I18n babel
babel-lang: russian
babel-otherlangs: english

## Fonts
mainfont: DejaVu Serif
sansfont: DejaVu Sans
monofont: DejaVu Sans Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9

## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric

## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"

## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Основной целью работы является знакомство с принципами работы дисциплины очереди Token Bucket Filter, которая формирует входящий/исходящий
трафик для ограничения пропускной способности, а также получение навыков
моделирования и исследования поведения трафика посредством проведения
интерактивного и воспроизводимого экспериментов в Mininet.

# Задание

1. Задайте топологию (рис. 6.3), состоящую из двух хостов и двух коммутаторов
с назначенной по умолчанию mininet сетью 10.0.0.0/8.

2. Проведите интерактивные эксперименты по ограничению пропускной способности сети с помощью TBF в эмулируемой глобальной сети.
3. Самостоятельно реализуйте воспроизводимые эксперимент по применению
TBF для ограничения пропускной способности. Постройте соответствующие
графики.

# Выполнение лабораторной работы

## 1. Запуск лабораторной топологии

1. Запустите виртуальную среду с mininet.
2. Из основной ОС подключитесь к виртуальной машине:

![рис. 1.1](images/1.png){#fig:001 width=70%}

3. В виртуальной машине mininet при необходимости исправьте права запуска
X-соединения. Скопируйте значение куки (MIT magic cookie)1
своего пользователя mininet в файл для пользователя root:

![рис. 1.2](images/2.png){#fig:002 width=70%}

4. Задайте топологию сети, состоящую из двух хостов и двух коммутаторов
с назначенной по умолчанию mininet сетью 10.0.0.0/8:

![рис. 1.3](images/3.png){#fig:003 width=70%}

5. На хостах h1, h2 и на коммутаторах s1, s2 введите команду ifconfig, чтобы
отобразить информацию, относящуюся к их сетевым интерфейсам и назначенным им IP-адресам. 

![рис. 1.4](images/4.png){#fig:004 width=70%}

6. Проверьте подключение между хостами h1 и h2 с помощью команды ping
с параметром -c 4.

![рис. 1.5](images/5.png){#fig:005 width=70%}

7. В терминале хоста h2 запустите iPerf3 в режиме сервера:

![рис. 1.6](images/6.png){#fig:006 width=70%}

8. В терминале хоста h1 запустите iPerf3 в режиме клиента:

![рис. 1.7](images/7.png){#fig:007 width=70%}


## 2. Ограничение скорости на конечных хостах

Команду tc можно применить к сетевому интерфейсу устройства для формирования исходящего трафика. Требуется ограничить скорость отправки данных
с конечного хоста с помощью фильтра Token Bucket Filter (tbf).
1. Измените пропускную способность хоста h1, установив пропускную способность на 10 Гбит/с на интерфейсе h1-eth0 и параметры TBF-фильтра:

![рис. 2.1](images/8.png){#fig:008 width=70%}

3. С помощью iPerf3 проверьте, что значение пропускной способности изменилось:
– В терминале хоста h2 запустите iPerf3 в режиме сервера:

![рис. 2.2](images/9.png){#fig:009 width=70%}

– В терминале хоста h2 запустите iPerf3 в режиме клиента:

![рис. 2.3](images/10.png){#fig:010 width=70%}

4. Удалите модифицированную конфигурацию на хосте h1:

![рис. 2.4](images/11.png){#fig:011 width=70%}


---

## 3. Ограничение скорости на коммутаторах

При ограничении скорости на интерфейсе s1-eth2 коммутатора s1 все сеансы связи между коммутатором s1 и коммутатором s2 будут фильтроваться
в соответствии с применяемыми правилами.
1. Примените правило ограничения скорости tbf с параметрами rate = 10gbit,
burst = 5,000,000, limit= 15,000,000 к интерфейсу s1-eth2 коммутатора s1,
который соединяет его с коммутатором s2:

![рис. 3.1](images/12.png){#fig:012 width=70%}


2. Проверьте конфигурацию с помощью инструмента iperf3 для измерения
пропускной способности:
– В терминале хоста h2 запустите iPerf3 в режиме сервера

– В терминале хоста h2 запустите iPerf3 в режиме клиента:

![рис. 3.2](images/13.png){#fig:013 width=70%}

3. Удалите модифицированную конфигурацию на коммутаторе s1:

![рис. 3.3](images/14.png){#fig:014 width=70%}


---

## 4. Объединение NETEM и TBF

NETEM используется для изменения задержки, джиттера, повреждения пакетов и т.д. TBF может использоваться для ограничения скорости. Утилита tc
позволяет комбинировать несколько модулей. При этом первая дисциплина
очереди (qdisc1) присоединяется к корневой метке, последующие дисциплины
очереди можно прикрепить к своим родителям, указав правильную метку.
1. Объедините NETEM и TBF, введя на интерфейсе s1-eth2 коммутатора s1
задержку, джиттер, повреждение пакетов и указав скорость:

![рис. 4.1](images/15.png){#fig:015 width=70%}

2. Убедитесь, что соединение от хоста h1 к хосту h2 имеет заданную задержку.
Для этого запустите команду ping с параметром -c 4 с терминала хоста h1

![рис. 4.2](images/16.png){#fig:016 width=70%}

3. Добавьте второе правило на коммутаторе s1, которое задаёт ограничение скорости с помощью tbf с параметрами rate=2gbit, burst=1,000,000,
limit=2,000,000:

![рис. 4.3](images/17.png){#fig:017 width=70%}

4. Проверьте конфигурацию с помощью инструмента iperf3 для измерения
пропускной способности:
– В терминале хоста h2 запустите iPerf3 в режиме сервера:

– В терминале хоста h2 запустите iPerf3 в режиме клиента:

![рис. 4.4](images/18.png){#fig:018 width=70%}

5. Удалите модифицированную конфигурацию на коммутаторе s1:



## 5. Воспроизводимые эксперименты

Создала каталог для экспееримента

Написала скрипт для эксперимента

![рис. 5.1](images/19.png){#fig:019 width=70%}

Написала скрипт для визуализации результатов эксперимента

![рис. 5.2](images/20.png){#fig:020 width=70%}

Задала права доступа к файлу скрипта

Создала Makefile для управления процессом проведения эксперимента

![рис. 5.3](images/21.png){#fig:021 width=70%}

Выполнила экперимент

Построила график

![рис. 5.4](images/22.png){#fig:022 width=70%}

Очистила каталог от результатов проведения экспериментов

![рис. 5.5](images/23.png){#fig:023 width=70%}


---

## 5. Выводы

Я познакомилась с принципами работы дисциплины очереди Token Bucket Filter, которая формирует входящий/исходящий трафик для ограничения пропускной способности, а также получила навыки моделирования и исследования поведения трафика посредством проведения интерактивного и воспроизводимого экспериментов в Mininet.


---


